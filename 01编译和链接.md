# 1编译运行隐藏的过程
&emsp;&#9728;编译运行可以分解为4个步骤，**预处理（Preprossing）、编译（Compilation）、汇编（Assembly）和链接（Linking）**。
## 1.1 预编译
&emsp;源代码文件的相关头文件，如stdio.h等被预编译器cpp预编译成一个.i文件。第一步预编译的过程相当于如下命令（-E表示只进行预编译）：
`
gcc -E hello.c hello.i 
`
或者：
`
cpp hello.c > hello.i
`
&emsp;主要处理规则如下：
+ 将所有的#define删除，并且展开所有的宏定义。
+ 处理所有条件预编译指令，比如"#if"、"#ifdef"、"#elif"、"#else"、"#endif"。
+ 处理"#include"预编译指令，将被包含的文件插入到该预编译指令的位置。这个过程是递归的。
+ 删除所有注释。
+ 添加行号和文件名标识。已便编译时产生编译错误的行号。
+ 保留所有#pragma编译器指令，因为编译器须要使用他们。  
&emsp;经过预编译后的.i文件不包含任何宏定义，因为所有的宏已经被展开，并且包含的文件也已经被插入到.i文件中。所以当我们无法判断宏定义是否正确或头文件是否正常时，可以查看预编译后的文件来确定问题。
## 1.2 编译器做了什么
&emsp;&#9728;从最直观的角度来讲，编译器就是将高级语言翻译成机器语言的一个工具。这个过程一般可以**分为6步：扫描、语法分析、语义分析、源代码优化、代码生成和目标代码优化**。
### 1.2.1 语法分析。
&emsp;首先源代码程序被输入到**扫描器（Scanner）**，扫描器的任务将源代码字符串分割成一系列的**记号（token）**。比如有如下源代码段
`
array[index] = (index + 4) * (2 + 6)
`
|  记号   | 类型  |
|  ----  | ----  |
| array  | 标识符 |
| \[  | 左方括号 |
| index  | 标识符 |
| \]  | 右方括号 |
| =  | 赋值 |
| (  | 左圆括号 |
| index  | 标识符 |
| +  | 加号 |
| 4  | 数字 |
| )  | 右圆括号 |
| \*  | 乘号 |
| (  | 左圆括号 |
| 2  | 数字 |
| +  | 加号 |
| 6  | 数字 |
| )  | 右圆括号 |
